<div class="container">
  <h1 *ngIf="isEditMode; else createTitle">Editando Quadrinho</h1>
  <ng-template #createTitle><h1>Cadastrar Novo Quadrinho</h1></ng-template>

  <div *ngIf="mensagem" [class]="'mensagem ' + tipoMensagem">
    {{ mensagem }}
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="nome">Nome do Quadrinho:</label>
      <input type="text" id="nome" formControlName="nome">
      <div *ngIf="form.get('nome')?.invalid && form.get('nome')?.touched" class="erro">
        Nome é obrigatório (4-60 caracteres)
      </div>
    </div>

    <div class="form-group">
      <label for="descricao">Descrição:</label>
      <textarea id="descricao" formControlName="descricao" rows="4"></textarea>
      <div *ngIf="form.get('descricao')?.invalid && form.get('descricao')?.touched" class="erro">
        Descrição é obrigatória
      </div>
    </div>

    <div class="form-group">
      <label for="preco">Preço:</label>
      <input type="number" id="preco" formControlName="preco" step="0.01">
      <div *ngIf="form.get('preco')?.invalid && form.get('preco')?.touched" class="erro">
        Preço deve ser maior ou igual a 0
      </div>
    </div>

    <div class="form-group">
      <label for="quantPaginas">Quantidade de Páginas:</label>
      <input type="number" id="quantPaginas" formControlName="quantPaginas">
      <div *ngIf="form.get('quantPaginas')?.invalid && form.get('quantPaginas')?.touched" class="erro">
        Deve ter pelo menos 1 página
      </div>
    </div>

    <div class="form-group">
      <label for="id_material">Material:</label>
      <select id="id_material" formControlName="id_material">
        <option value="">Selecione o material</option>
        <option *ngFor="let material of materiais" [value]="material.id">
          {{ material.nome }}
        </option>
      </select>
      <div *ngIf="form.get('id_material')?.invalid && form.get('id_material')?.touched" class="erro">
        Material é obrigatório
      </div>
    </div>

    <div class="form-group">
      <label for="id_fornecedor">Fornecedor:</label>
      <select id="id_fornecedor" formControlName="id_fornecedor">
        <option value="">Selecione o fornecedor</option>
        <option *ngFor="let fornecedor of fornecedores" [value]="fornecedor.id">
          {{ fornecedor.nome }}
        </option>
      </select>
      <div *ngIf="form.get('id_fornecedor')?.invalid && form.get('id_fornecedor')?.touched" class="erro">
        Fornecedor é obrigatório
      </div>
    </div>

        <div class="form-group">
      <label for="imagem">Imagem do Quadrinho:</label>
      <div *ngIf="imageUrl" class="image-preview">
        <img [src]="imageUrl" alt="Prévia da imagem" style="max-width: 200px; margin-top: 10px; border-radius: 4px;">
      </div>
      <input type="file" id="imagem" (change)="onFileSelected($event)" accept="image/png, image/jpeg, image/gif">
    </div>


    <div class="form-group">
      <label for="estoque">Estoque:</label>
      <input type="number" id="estoque" formControlName="estoque">
      <div *ngIf="form.get('estoque')?.invalid && form.get('estoque')?.touched" class="erro">
        Estoque deve ser maior ou igual a 0
      </div>
    </div>

    <div class="actions">
      <button type="submit" [disabled]="form.invalid">Salvar</button>
      <a routerLink="/quadrinhos">Cancelar</a>
    </div>
  </form>
</div>
