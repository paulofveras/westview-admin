<div class="cadastro-container">
  <div class="cadastro-card">
    <h2>{{ isEdit ? 'Editando Cliente' : 'Novo Cliente' }}</h2>

    <form [formGroup]="formGroup">
      
      <div class="section-title">Dados Pessoais</div>
      
      <div class="form-row">
        <div class="form-group full-width">
          <label>Nome Completo</label>
          <input type="text" formControlName="nome" placeholder="Ex: Wanda Maximoff">
          <small class="error-msg" *ngIf="formGroup.get('nome')?.invalid && formGroup.get('nome')?.touched">
            Mínimo de 2 caracteres.
          </small>
        </div>
      </div>
      
      <div class="form-row">
        <div class="form-group full-width">
          <label>CPF</label>
          <input type="text" formControlName="cpf" placeholder="Apenas números (11 dígitos)" maxlength="11">
          <small class="error-msg" *ngIf="formGroup.get('cpf')?.invalid && formGroup.get('cpf')?.touched">
            Deve conter exatamente 11 números.
          </small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group full-width">
          <label>Email</label>
          <input type="email" formControlName="email" placeholder="email@exemplo.com">
          <small class="error-msg" *ngIf="formGroup.get('email')?.invalid && formGroup.get('email')?.touched">
            Formato inválido (ex: nome@dominio.com).
          </small>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label>Username (Login)</label>
          <input type="text" formControlName="username">
          <small class="error-msg" *ngIf="formGroup.get('username')?.invalid && formGroup.get('username')?.touched">
            Obrigatório (min 3 caracteres).
          </small>
        </div>
        <div class="form-group">
          <label>Senha <span *ngIf="isEdit" style="font-weight:normal; font-size:0.8em">(opcional na edição)</span></label>
          <input type="password" formControlName="senha">
          <small class="error-msg" *ngIf="formGroup.get('senha')?.invalid && formGroup.get('senha')?.touched">
            Obrigatória na criação.
          </small>
        </div>
      </div>

      <div class="section-title">Endereço</div>
      <div class="form-row" formGroupName="endereco">
        <div class="form-group small-field">
          <label>CEP</label>
          <input type="text" formControlName="cep" placeholder="00000000" maxlength="8" (blur)="buscarCep()">
          <small class="error-msg" *ngIf="formGroup.get('endereco.cep')?.invalid && formGroup.get('endereco.cep')?.touched">
            Exatamente 8 números.
          </small>
        </div>
        <div class="form-group full-width">
          <label>Rua</label>
          <input type="text" formControlName="rua" placeholder="Preenchimento automático...">
          <small class="error-msg" *ngIf="formGroup.get('endereco.rua')?.invalid && formGroup.get('endereco.rua')?.touched">
            Obrigatório.
          </small>
        </div>
        <div class="form-group small-field">
          <label>Nº</label>
          <input type="number" id="numeroInput" formControlName="numero">
          <small class="error-msg" *ngIf="formGroup.get('endereco.numero')?.invalid && formGroup.get('endereco.numero')?.touched">
            Obrig.
          </small>
        </div>
      </div>

      <div class="section-title">Telefone</div>
      <div class="form-row" formGroupName="telefone">
        <div class="form-group small-field">
          <label>DDD</label>
          <input type="text" formControlName="codigoArea" placeholder="XX" maxlength="2">
          <small class="error-msg" *ngIf="formGroup.get('telefone.codigoArea')?.invalid && formGroup.get('telefone.codigoArea')?.touched">
            2 dígitos.
          </small>
        </div>
        <div class="form-group full-width">
          <label>Número</label>
          <input type="text" formControlName="numero" placeholder="9XXXX-XXXX">
          <small class="error-msg" *ngIf="formGroup.get('telefone.numero')?.invalid && formGroup.get('telefone.numero')?.touched">
            Mínimo 8 dígitos.
          </small>
        </div>
      </div>

      <div class="actions">
        <a routerLink="/clientes/list" class="btn-secondary">Cancelar</a>
        <button type="button" class="btn-danger" (click)="excluir()" *ngIf="isEdit">Excluir</button>
        <button type="button" class="btn-primary" (click)="salvar()" [disabled]="formGroup.invalid">Salvar</button>
      </div>
    </form>
  </div>
</div>
